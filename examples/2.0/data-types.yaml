tosca_definitions_version: tosca_2_0

imports:
  - url: https://raw.githubusercontent.com/xDaryamo/tosca-community-contributions/refs/heads/master/profiles/org/oasis-open/simple/2.0/profile.yaml
    namespace: tosca

metadata:
  template_name: Data Types Example
  template_author: Puccini

node_types:
  DataNode:
    properties:
      string:
        type: string
      integer:
        type: integer
      float:
        type: float
        default: -0.1
      boolean:
        type: boolean
        required: false
      'null':
        type: nil
      integer-list:
        type: list
        entry_schema: integer
      string-map:
        type: map
        entry_schema: string
      complex:
        type: Complex
      complex-list:
        type: list
        entry_schema: Complex
      size:
        type: tosca:Size
      time:
        type: tosca:Time
      frequency:
        type: tosca:Frequency
      bitrate:
        type: tosca:Bitrate
      timestamp:
        type: timestamp
      version:
        type: version
      range:
        type: range
      json:
        type: tosca:json
      xml:
        type: tosca:xml
      constrained-string:
        type: string
        validation:
          $and:
            - $greater_or_equal: [ { $length: $value }, 2 ]
            - $less_or_equal: [ { $length: $value }, 16 ]

      lowercase:
        type: LowerCase
      lowercase-string-map:
        type: map
        key_schema: LowerCase
        entry_schema: string
      constrained-float-list:
        type: list
        entry_schema:
          type: float
          validation:
            $in_range: [ $value, [-1.0, 1.0] ]
      constrained-time:
        type: tosca:Time
        validation:
          $in_range: [ $value, [1 m, 1 h] ]
      constrained-version:
        type: version
        validation:
          $in_range: [ $value, [1.2.3.beta-3, 1.2.3.beta-5] ]
      time-map:
        type: TimeMap

data_types:
  Complex:
    properties:
      string:
        type: string
        default: Default Value
      integer:
        type: integer
      float:
        type: float
        required: false
      nested:
        type: Nested

  Nested:
    properties:
      nested-float:
        type: float
        validation:
          $greater_or_equal: [ $value, 0.0 ]
      nested_string:
        type: string
        required: false

  LowerCase:
    derived_from: string
    description: Lowercase string
    validation:
      $matches: [ $value, '[a-z]*' ]

  TimeMap:
    derived_from: map
    entry_schema: tosca:Time


service_template:
  inputs:
    number:
      type: integer
      default: 4

  node_templates:
    data:
      type: DataNode
      properties:
        string: Hello, Puccini
        integer: 123
        float: 12.3
        boolean: true
        'null': null
        integer-list: [ 1, 2, 3, { $get_input: number } ]
        string-map:
          Greeting: Hello
          Message: { $concat: [ Good, ' ', Day ] }
          { $concat: [ Recip, ient ] }: Puccini
        lowercase-string-map:
          greeting: Hello
          { $concat: [ recip, ient ] }: Puccini
        complex:
          string: Hello, Puccini
          integer: 123
          nested:
            nested-float: 12.3
        complex-list:
          - integer: 123
            nested:
              nested-float: 45.6
          - integer: 789
            nested:
              nested-float: 1.0
        size: 1.23 GiB
        time: 1.23 ms
        frequency: 123 kHz
        bitrate: 1.23 MiBps
        timestamp: '1975-09-15 12:34:56.7 +2'
        version: 1.2.3.beta-4
        range: [ 1, UNBOUNDED ]
        json: |-
          {
            "key1": "value",
            "key2": [ 1, 2, 3 ]
          }
        xml:
          $concat:
            - |
              <data>
                <entry>1</entry>
                <entry>2</entry>
                <entry>3</entry>
            - |-
              </data>
        constrained-string: ABCDE
        lowercase: helloworld
        constrained-float-list:
          - -0.999
          - 0.0
          - 1.0
        constrained-time: 10.5 m
        constrained-version: 1.2.3.beta-4
        time-map:
          first: 100 s
          second: 200 s
